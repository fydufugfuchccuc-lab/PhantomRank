<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PhantomRank — Created By Qrux & Mira</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Jost:wght@200;300;400;500&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
:root{
  --w:#ffffff;--g:#c8a45a;--gl:#dfc07e;--gd:#8e6e2e;--gp:#fbf6eb;
  --t:#141210;--t2:#7a7060;--t3:#b8ae9e;--b:#ede8de;--b2:#f5f1ea;
}
body{background:var(--w);color:var(--t);font-family:'Jost',sans-serif;font-weight:300;overflow-x:hidden}
::selection{background:var(--gl);color:var(--w)}
::-webkit-scrollbar{width:3px}::-webkit-scrollbar-thumb{background:var(--gl)}

/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:900;height:58px;display:flex;align-items:center;justify-content:space-between;padding:0 52px;background:rgba(255,255,255,.96);backdrop-filter:blur(16px);border-bottom:1px solid transparent;transition:border-color .3s,box-shadow .3s}
nav.s{border-color:var(--b);box-shadow:0 1px 20px rgba(200,164,90,.07)}
.logo{font-family:'Cormorant',serif;font-size:1.3rem;font-weight:600;letter-spacing:4px;text-transform:uppercase;color:var(--t);cursor:default;user-select:none}
.logo i{color:var(--g);font-style:normal}
.nav-r{display:flex;align-items:center;gap:24px}
.nav-pill{font-size:.6rem;font-weight:500;letter-spacing:2.5px;text-transform:uppercase;color:var(--t2);background:none;border:none;cursor:pointer;transition:color .2s;padding:0}
.nav-pill:hover{color:var(--g)}
#adminBadge{font-size:.58rem;letter-spacing:2px;text-transform:uppercase;color:var(--g);border:1px solid var(--gl);padding:3px 10px;display:none}

/* HERO */
.hero{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:100px 40px 80px;position:relative;overflow:hidden}
.hero::after{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 65% 45% at 50% 5%,rgba(200,164,90,.05) 0%,transparent 70%);pointer-events:none}
.h-eye{font-size:.58rem;font-weight:500;letter-spacing:5px;text-transform:uppercase;color:var(--g);margin-bottom:30px;opacity:0;animation:up .7s .15s forwards}
.h-title{font-family:'Cormorant',serif;font-size:clamp(3rem,7vw,6.2rem);font-weight:300;line-height:1.05;letter-spacing:-1px;opacity:0;animation:up .9s .35s forwards}
.h-title em{font-style:italic;color:var(--g)}
.h-sub{margin-top:18px;font-size:.78rem;color:var(--t3);font-weight:300;letter-spacing:.5px;max-width:400px;line-height:1.7;opacity:0;animation:up .9s .55s forwards}
.h-line{width:40px;height:1px;background:var(--gl);margin:30px auto;opacity:0;animation:fade .9s .8s forwards}
.h-stamp{font-family:'Cormorant',serif;font-size:.78rem;font-weight:400;letter-spacing:3.5px;text-transform:uppercase;color:var(--gd);border:1px solid var(--gl);padding:8px 22px;background:var(--gp);opacity:0;animation:up .7s 1s forwards}
.h-scroll{position:absolute;bottom:38px;left:50%;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;gap:7px;font-size:.56rem;letter-spacing:2px;text-transform:uppercase;color:var(--t3);cursor:pointer;opacity:0;animation:fade 1s 1.6s forwards}
.h-scroll-bar{width:1px;height:32px;background:var(--gl);animation:pulse 2.5s 2s infinite}
@keyframes up{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes fade{from{opacity:0}to{opacity:1}}
@keyframes pulse{0%,100%{opacity:1;transform:scaleY(1)}50%{opacity:.3;transform:scaleY(.5)}}

/* ANALYSIS */
#analysis{border-top:1px solid var(--b);padding:64px 52px}
.analysis-head{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:36px;flex-wrap:wrap;gap:8px}
.analysis-title-block .sec-eyebrow{font-size:.58rem;font-weight:500;letter-spacing:4px;text-transform:uppercase;color:var(--g);margin-bottom:7px}
.analysis-title-block .sec-h{font-family:'Cormorant',serif;font-size:clamp(1.6rem,2.5vw,2.4rem);font-weight:400}
.analysis-date{font-size:.6rem;letter-spacing:2px;text-transform:uppercase;color:var(--t3)}
.analysis-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1px;background:var(--b);border:1px solid var(--b);margin-bottom:28px}
.a-card{background:var(--w);padding:18px 20px}
.a-card-label{font-size:.56rem;letter-spacing:2px;text-transform:uppercase;color:var(--t3);margin-bottom:4px}
.a-card-value{font-family:'Cormorant',serif;font-size:1.6rem;font-weight:600;color:var(--gd);line-height:1.1}
.a-card-sub{font-size:.68rem;color:var(--t3);margin-top:4px;font-weight:300}
.a-insights{display:grid;grid-template-columns:1fr 1fr;gap:1px;background:var(--b);border:1px solid var(--b)}
.a-insight{background:var(--w);padding:16px 18px}
.a-insight-label{font-size:.56rem;letter-spacing:2px;text-transform:uppercase;color:var(--g);margin-bottom:6px}
.a-insight-text{font-size:.82rem;color:var(--t2);line-height:1.6;font-weight:300}
.a-cat-bars{margin-top:28px}
.a-cat-title{font-size:.58rem;font-weight:500;letter-spacing:3px;text-transform:uppercase;color:var(--t3);margin-bottom:14px}
.a-bar-row{display:flex;align-items:center;gap:12px;margin-bottom:10px}
.a-bar-label{font-size:.64rem;letter-spacing:1px;text-transform:uppercase;color:var(--t2);width:110px;flex-shrink:0}
.a-bar-wrap{flex:1;height:3px;background:var(--b2);overflow:hidden}
.a-bar-fill{height:100%;background:linear-gradient(90deg,var(--gl),var(--g));transition:width .9s cubic-bezier(.4,0,.2,1)}
.a-bar-val{font-family:'Cormorant',serif;font-size:.9rem;font-weight:600;color:var(--gd);width:44px;text-align:right;flex-shrink:0}

/* RANKINGS */
#rankings{border-top:1px solid var(--b)}
.sec-top{padding:64px 52px 0;display:flex;align-items:flex-end;justify-content:space-between}
.sec-eyebrow{font-size:.58rem;font-weight:500;letter-spacing:4px;text-transform:uppercase;color:var(--g);margin-bottom:7px}
.sec-h{font-family:'Cormorant',serif;font-size:clamp(1.6rem,2.5vw,2.4rem);font-weight:400;line-height:1.1}
.sec-count{font-family:'Cormorant',serif;font-size:4rem;font-weight:300;color:var(--b);line-height:1;letter-spacing:-2px}

/* FILTERS */
.fbar{padding:24px 52px 0;display:flex;gap:5px;flex-wrap:wrap}
.fp{padding:5px 14px;border:1px solid var(--b);background:transparent;color:var(--t3);font-family:'Jost',sans-serif;font-size:.6rem;font-weight:500;letter-spacing:1.5px;text-transform:uppercase;cursor:pointer;transition:all .2s}
.fp:hover{border-color:var(--gl);color:var(--g)}
.fp.on{background:var(--g);border-color:var(--g);color:var(--w)}

/* SORT CONTROLS */
.ctrl{padding:12px 52px 0;display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.ctrl input{border:none;border-bottom:1px solid var(--b);background:transparent;color:var(--t);font-family:'Jost',sans-serif;font-size:.75rem;font-weight:300;padding:6px 2px;outline:none;width:160px;transition:border-color .2s;flex-shrink:0}
.ctrl input::placeholder{color:var(--t3)}
.ctrl input:focus{border-color:var(--g)}
.slbl{font-size:.58rem;font-weight:500;letter-spacing:2px;text-transform:uppercase;color:var(--t3);flex-shrink:0}
.sort-group{display:flex;align-items:center;gap:4px;flex-wrap:wrap}
.sbtn{background:none;border:none;border-bottom:1px solid transparent;cursor:pointer;font-family:'Jost',sans-serif;font-size:.58rem;font-weight:500;letter-spacing:1.5px;text-transform:uppercase;color:var(--t3);padding:3px 6px;transition:all .2s;white-space:nowrap}
.sbtn.on,.sbtn:hover{color:var(--g);border-color:var(--g)}
.sort-sep{color:var(--b);font-size:.7rem;flex-shrink:0}

/* GRID */
.grid{padding:28px 52px 80px;display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1px;background:var(--b)}

/* CARD */
.card{background:var(--w);cursor:pointer;position:relative;overflow:hidden;opacity:0;animation:up .45s forwards;transition:box-shadow .3s,transform .3s}
.card:hover{box-shadow:0 8px 40px rgba(200,164,90,.1);transform:translateY(-2px);z-index:2}
.card-top-line{position:absolute;top:0;left:0;right:0;height:1.5px;background:var(--b)}
.r1 .card-top-line{background:var(--g)}.r2 .card-top-line{background:var(--gl)}.r3 .card-top-line{background:var(--gd)}
.card-img{height:200px;background:var(--b2);display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}
.card-img img{width:100%;height:100%;object-fit:contain;padding:14px;transition:transform .4s cubic-bezier(.4,0,.2,1)}
.card:hover .card-img img{transform:scale(1.04)}
.no-img{display:flex;flex-direction:column;align-items:center;gap:8px}
.no-img svg{opacity:.15}
.no-img span{font-size:.56rem;letter-spacing:2px;text-transform:uppercase;color:var(--t3)}
.card-score-badge{position:absolute;bottom:10px;right:10px;background:var(--w);border:1px solid var(--b);color:var(--gd);font-family:'Cormorant',serif;font-size:1.4rem;font-weight:600;padding:2px 10px;line-height:1.3}
.r1 .card-score-badge{background:var(--g);border-color:var(--g);color:var(--w)}
.r2 .card-score-badge{background:var(--gl);border-color:var(--gl);color:var(--w)}
.card-rank{position:absolute;top:11px;left:11px;font-family:'Cormorant',serif;font-size:.76rem;font-weight:600;letter-spacing:.5px;color:var(--t3)}
.r1 .card-rank{color:var(--g)}.r2 .card-rank{color:var(--gl)}.r3 .card-rank{color:var(--gd)}
.card-edit-btn{position:absolute;top:9px;right:9px;width:26px;height:26px;background:var(--w);border:1px solid var(--b);display:none;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;z-index:5}
.card-edit-btn:hover{background:var(--g);border-color:var(--g)}
.card-edit-btn:hover svg{stroke:var(--w)}
.card-edit-btn svg{stroke:var(--t3);transition:stroke .2s}
body.admin-on .card-edit-btn{display:flex}
.card-body{padding:14px 16px 10px}
.card-meta{display:flex;justify-content:space-between;align-items:baseline}
.card-brand{font-size:.56rem;font-weight:500;letter-spacing:2.5px;text-transform:uppercase;color:var(--g)}
.card-cat{font-size:.54rem;font-weight:400;letter-spacing:1px;text-transform:uppercase;color:var(--t3);border:1px solid var(--b);padding:1px 5px}
.card-name{font-family:'Cormorant',serif;font-size:1.15rem;font-weight:500;line-height:1.2;margin-top:3px}
.card-mini{margin-top:10px;padding-top:9px;border-top:1px solid var(--b2);display:grid;grid-template-columns:repeat(3,1fr)}
.ms .v{font-family:'Cormorant',serif;font-size:1rem;font-weight:600;color:var(--gd);text-align:center}
.ms .l{font-size:.52rem;letter-spacing:1px;text-transform:uppercase;color:var(--t3);text-align:center;margin-top:1px}
.card-foot{padding:8px 16px;border-top:1px solid var(--b2);display:flex;justify-content:space-between;align-items:center}
.card-price{font-family:'Cormorant',serif;font-size:.9rem;font-weight:500;color:var(--t)}
.card-yr{font-size:.56rem;letter-spacing:1px;color:var(--t3)}
.empty{grid-column:1/-1;padding:80px 40px;text-align:center;background:var(--w)}
.empty h3{font-family:'Cormorant',serif;font-size:1.8rem;font-weight:300;color:var(--b)}
.empty p{font-size:.76rem;color:var(--t3);margin-top:5px}

/* FAB */
.fab{position:fixed;bottom:30px;right:30px;z-index:800;width:46px;height:46px;background:var(--g);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 20px rgba(200,164,90,.28);transition:all .3s;opacity:0;pointer-events:none}
.fab.on{opacity:1;pointer-events:all}
.fab:hover{background:var(--gd);transform:scale(1.06)}
.fab svg{stroke:var(--w)}

/* OVERLAYS */
.ov{position:fixed;inset:0;z-index:1000;background:rgba(250,247,240,.9);backdrop-filter:blur(12px);display:flex;align-items:center;justify-content:center;padding:16px;opacity:0;pointer-events:none;transition:opacity .25s}
.ov.on{opacity:1;pointer-events:all}
.m{background:var(--w);border:1px solid var(--b);width:100%;max-width:600px;max-height:93vh;overflow-y:auto;transform:translateY(14px);transition:transform .3s cubic-bezier(.4,0,.2,1);box-shadow:0 16px 60px rgba(0,0,0,.06)}
.ov.on .m{transform:translateY(0)}
.mh{padding:20px 26px;border-bottom:1px solid var(--b);display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;background:var(--w);z-index:2}
.mt{font-family:'Cormorant',serif;font-size:1.2rem;font-weight:500;letter-spacing:1px}
.xb{width:28px;height:28px;border:1px solid var(--b);background:none;color:var(--t3);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:.85rem;transition:all .2s}
.xb:hover{border-color:var(--g);color:var(--g)}
.mb{padding:22px 26px}
.mf{padding:16px 26px;border-top:1px solid var(--b);display:flex;justify-content:flex-end;gap:8px;align-items:center;flex-wrap:wrap}

/* TABS */
.tabs{display:flex;border-bottom:1px solid var(--b);margin-bottom:22px}
.tab{padding:10px 20px;font-size:.62rem;font-weight:500;letter-spacing:2px;text-transform:uppercase;color:var(--t3);background:none;border:none;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s}
.tab.on{color:var(--g);border-color:var(--g)}
.tab-panel{display:none}.tab-panel.on{display:block}

/* FORMS */
.fr{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px}
.fg{display:flex;flex-direction:column;gap:4px}
.fg.full{grid-column:1/-1}
.fl{font-size:.58rem;font-weight:500;letter-spacing:2px;text-transform:uppercase;color:var(--t3)}
.fi,.fse,.fta{background:var(--b2);border:1px solid var(--b);color:var(--t);padding:8px 11px;font-family:'Jost',sans-serif;font-size:.82rem;font-weight:300;outline:none;transition:border-color .2s;resize:vertical;width:100%}
.fi:focus,.fse:focus,.fta:focus{border-color:var(--g);background:var(--w)}
.fse{appearance:none;cursor:pointer}

/* IMAGE UPLOAD */
.iub{border:2px dashed var(--b);background:var(--b2);padding:24px;text-align:center;cursor:pointer;transition:all .2s}
.iub:hover{border-color:var(--gl);background:var(--gp)}
.iub.has{border-style:solid;border-color:var(--gl);padding:7px;background:var(--w)}
.iub img{max-height:150px;max-width:100%;object-fit:contain;display:block;margin:0 auto}
.iph{display:flex;flex-direction:column;align-items:center;gap:6px}
.iph svg{opacity:.3}
.iph span{font-size:.6rem;letter-spacing:1.5px;text-transform:uppercase;color:var(--t3)}
#imgF{display:none}
.rim{display:none;font-size:.58rem;letter-spacing:1px;text-transform:uppercase;background:none;border:none;color:var(--t3);cursor:pointer;margin-top:4px;text-align:left}

/* SCORES — 2-col, mobile safe */
.sc-block{background:var(--b2);border:1px solid var(--b);padding:16px}
.sc-title{font-size:.58rem;font-weight:500;letter-spacing:2.5px;text-transform:uppercase;color:var(--g);margin-bottom:14px}
.sc-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.sc-f{display:flex;flex-direction:column;gap:5px}
.sc-f label{font-size:.58rem;letter-spacing:1.5px;text-transform:uppercase;color:var(--t3)}
.sc-f input{background:var(--w);border:1px solid var(--b);color:var(--t);padding:10px 8px;text-align:center;font-family:'Cormorant',serif;font-size:1.2rem;font-weight:600;outline:none;transition:border-color .2s;width:100%;min-width:0}
.sc-f input:focus{border-color:var(--g)}
.ov-show{margin-top:14px;padding-top:14px;border-top:1px solid var(--b);text-align:center}
.ov-show .ovn{font-family:'Cormorant',serif;font-size:2.6rem;font-weight:600;color:var(--gd);line-height:1}
.ov-show .ovl{font-size:.58rem;letter-spacing:2px;text-transform:uppercase;color:var(--t3);margin-top:2px}

/* RANK EDITOR */
.rank-override{display:flex;flex-direction:column;gap:10px}
.rank-item{display:flex;align-items:center;gap:12px;padding:10px 14px;border:1px solid var(--b);background:var(--b2);cursor:grab;transition:border-color .2s}
.rank-item:hover{border-color:var(--gl)}
.rank-item.dragging{opacity:.4;border-color:var(--g)}
.rank-item.drag-over{border-color:var(--g);background:var(--gp)}
.ri-num{font-family:'Cormorant',serif;font-size:1.1rem;font-weight:600;color:var(--t3);width:24px;flex-shrink:0}
.ri-img{width:36px;height:36px;background:var(--w);border:1px solid var(--b);overflow:hidden;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.ri-img img{width:100%;height:100%;object-fit:contain;padding:2px}
.ri-name{flex:1;min-width:0}
.ri-brand{font-size:.56rem;letter-spacing:2px;text-transform:uppercase;color:var(--g)}
.ri-model{font-family:'Cormorant',serif;font-size:.95rem;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.ri-score{font-family:'Cormorant',serif;font-size:1.2rem;font-weight:600;color:var(--gd);flex-shrink:0}
.ri-drag{color:var(--t3);font-size:.9rem;padding:0 4px;flex-shrink:0}
.rank-hint{font-size:.62rem;color:var(--t3);letter-spacing:.5px;margin-bottom:12px;font-style:italic}

/* BUTTONS */
.btn{padding:9px 22px;border:none;cursor:pointer;font-family:'Jost',sans-serif;font-size:.62rem;font-weight:500;letter-spacing:2px;text-transform:uppercase;transition:all .2s;white-space:nowrap}
.bg{background:var(--g);color:var(--w)}.bg:hover{background:var(--gd)}
.bgo{background:transparent;border:1px solid var(--b);color:var(--t2)}.bgo:hover{border-color:var(--g);color:var(--g)}
.bdel{background:transparent;border:1px solid #e8d0d0;color:#b87878;margin-right:auto}.bdel:hover{background:#fff8f8}
.bdup{background:transparent;border:1px solid var(--gl);color:var(--gd)}.bdup:hover{background:var(--gp)}

/* DETAIL */
.dh-img{width:100%;height:230px;background:var(--b2);display:flex;align-items:center;justify-content:center;overflow:hidden}
.dh-img img{max-height:100%;max-width:100%;object-fit:contain;padding:16px}
.d-ov{text-align:center;padding:20px 0 8px;border-bottom:1px solid var(--b2)}
.d-ov .ds{font-family:'Cormorant',serif;font-size:3.4rem;font-weight:600;color:var(--gd);line-height:1}
.d-ov .dl{font-size:.56rem;letter-spacing:3px;text-transform:uppercase;color:var(--t3)}
.d-sg{display:grid;grid-template-columns:repeat(3,1fr);gap:1px;background:var(--b);border:1px solid var(--b);margin:16px 0}
.d-sc{background:var(--w);padding:10px 4px;text-align:center}
.d-sc .v{font-family:'Cormorant',serif;font-size:1.3rem;font-weight:600;color:var(--gd)}
.d-sc .l{font-size:.55rem;letter-spacing:1.5px;text-transform:uppercase;color:var(--t3)}
.bars{margin-bottom:16px}
.br{display:flex;align-items:center;gap:8px;margin-bottom:8px}
.bl{font-size:.58rem;letter-spacing:1px;text-transform:uppercase;color:var(--t3);width:78px;flex-shrink:0}
.bw{flex:1;height:2px;background:var(--b);overflow:hidden}
.bf{height:100%;background:var(--g);transition:width .7s cubic-bezier(.4,0,.2,1);max-width:100%}
.bv{font-family:'Cormorant',serif;font-size:.9rem;font-weight:600;color:var(--gd);width:32px;text-align:right;flex-shrink:0}
.d-desc{font-size:.82rem;color:var(--t2);line-height:1.75;margin-bottom:16px;font-weight:300}
.d-info{display:grid;grid-template-columns:1fr 1fr;gap:1px;background:var(--b);border:1px solid var(--b)}
.di{background:var(--w);padding:9px 11px}
.di .k{font-size:.54rem;letter-spacing:1.5px;text-transform:uppercase;color:var(--t3)}
.di .v{font-size:.82rem;font-weight:400;margin-top:2px}

/* LOGIN */
.lm .m{max-width:340px}
.ln{font-size:.68rem;color:var(--t3);font-style:italic;margin-top:4px}
.le{color:#b87878;font-size:.7rem;margin-top:6px;display:none}
.loc-text{font-size:.65rem;color:var(--t3);letter-spacing:.5px}

/* FOOTER */
footer{border-top:1px solid var(--b);padding:32px 52px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px}
.fl2{font-family:'Cormorant',serif;font-size:1rem;font-weight:500;letter-spacing:2px;text-transform:uppercase;color:var(--t3)}
.fb{font-size:.58rem;letter-spacing:2.5px;text-transform:uppercase;color:var(--g);font-weight:500}
.fc{font-size:.56rem;letter-spacing:.5px;color:var(--t3)}

/* MOBILE */
@media(max-width:700px){
  nav,footer,.sec-top,.fbar,.ctrl,.grid,#analysis{padding-left:18px;padding-right:18px}
  .fr{grid-template-columns:1fr}
  .sc-grid{grid-template-columns:1fr 1fr}
  nav .nav-r .nav-pill:not(#adminBadge){display:none}
  .ov{padding:8px}
  .m{max-width:100%!important;max-height:96vh}
  .mh,.mb,.mf{padding-left:14px;padding-right:14px}
  .sc-block{padding:14px}
  .sc-f input{font-size:1.1rem;padding:9px 6px}
  .a-insights{grid-template-columns:1fr}
  .ctrl{gap:8px}
  .sort-group{gap:3px}
  .mf{gap:6px}
  .btn{padding:8px 14px;font-size:.58rem}
  .d-sg{grid-template-columns:repeat(2,1fr)}
}
@media(max-width:400px){
  .sc-grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<nav id="nav">
  <div class="logo" id="logoTrig">Phantom<i>Rank</i></div>
  <div class="nav-r">
    <button class="nav-pill" onclick="goTo('analysis')">Analysis</button>
    <button class="nav-pill" onclick="goTo('rankings')">Rankings</button>
    <button class="nav-pill" onclick="fNav('flagship')">Flagship</button>
    <button class="nav-pill" onclick="fNav('foldable')">Foldable</button>
    <div id="adminBadge">Admin</div>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="h-eye">The Fictional Standard in Mobile Benchmarks</div>
  <h1 class="h-title">The World's <em>Finest</em><br>Imaginary Phones</h1>
  <p class="h-sub">Meticulous, fictional benchmarks for smartphones that transcend reality.</p>
  <div class="h-line"></div>
  <div class="h-stamp">✦ &ensp; Created By Qrux & Mira &ensp; ✦</div>
  <div class="h-scroll" onclick="goTo('analysis')">
    <div class="h-scroll-bar"></div>
    <span>Explore</span>
  </div>
</section>

<!-- ANALYSIS -->
<section id="analysis">
  <div class="analysis-head">
    <div class="analysis-title-block">
      <div class="sec-eyebrow">Updated Daily</div>
      <div class="sec-h">Rankings Analysis</div>
    </div>
    <div class="analysis-date" id="analysisDate"></div>
  </div>
  <div class="analysis-grid" id="analysisStats"></div>
  <div class="a-insights" id="analysisInsights"></div>
  <div class="a-cat-bars">
    <div class="a-cat-title">Average Score By Category</div>
    <div id="analysisCatBars"></div>
  </div>
</section>

<!-- RANKINGS -->
<section id="rankings">
  <div class="sec-top">
    <div>
      <div class="sec-eyebrow">Benchmark Rankings</div>
      <div class="sec-h">All Fictional Devices</div>
    </div>
    <div class="sec-count" id="secCnt">00</div>
  </div>
  <div class="fbar">
    <button class="fp on" onclick="setF('all',this)">All</button>
    <button class="fp" onclick="setF('flagship',this)">Flagship</button>
    <button class="fp" onclick="setF('premium',this)">Premium</button>
    <button class="fp" onclick="setF('mid-range',this)">Mid-Range</button>
    <button class="fp" onclick="setF('budget',this)">Budget</button>
    <button class="fp" onclick="setF('foldable',this)">Foldable</button>
    <button class="fp" onclick="setF('rugged',this)">Rugged</button>
    <button class="fp" onclick="setF('gaming',this)">Gaming</button>
    <button class="fp" onclick="setF('ultra-thin',this)">Ultra-Thin</button>
    <button class="fp" onclick="setF('camera-centric',this)">Camera-Centric</button>
    <button class="fp" onclick="setF('compact',this)">Compact</button>
    <button class="fp" onclick="setF('enterprise',this)">Enterprise</button>
  </div>
  <div class="ctrl">
    <input type="text" id="srch" placeholder="Search…" oninput="render()">
    <span class="slbl">Sort:</span>
    <div class="sort-group">
      <button class="sbtn on" onclick="setS('overall',this)">Overall</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('camera',this)">Camera</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('display',this)">Display</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('battery',this)">Battery</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('performance',this)">Perf.</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('audio',this)">Audio</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('build',this)">Build</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('name',this)">Name</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('price',this)">Price</button>
      <span class="sort-sep">·</span>
      <button class="sbtn" onclick="setS('manual',this)">Manual</button>
    </div>
  </div>
  <div class="grid" id="grid"></div>
</section>

<footer>
  <div class="fl2">Phantom<span style="color:var(--g)">Rank</span></div>
  <div class="fb">✦ &ensp; Created By Qrux & Mira &ensp; ✦</div>
  <div class="fc">Fictional benchmarks · All devices imaginary</div>
</footer>

<!-- Admin FAB -->
<button class="fab" id="fab" title="Add Phone" onclick="openAdd()">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
</button>

<!-- LOGIN -->
<div class="ov lm" id="loginOv" onclick="coOv(event,'loginOv')">
  <div class="m">
    <div class="mh"><span class="mt">Admin Access</span><button class="xb" onclick="cOv('loginOv')">✕</button></div>
    <div class="mb">
      <div class="fg">
        <label class="fl">Passphrase</label>
        <input class="fi" type="password" id="pwIn" placeholder="••••••••" onkeydown="if(event.key==='Enter')doLogin()">
        <span class="ln">Restricted · Admin only</span>
      </div>
      <div class="le" id="lerr">Incorrect passphrase.</div>
    </div>
    <div class="mf">
      <button class="btn bgo" onclick="cOv('loginOv')">Cancel</button>
      <button class="btn bg" onclick="doLogin()">Authenticate</button>
    </div>
  </div>
</div>

<!-- ADD / EDIT PHONE -->
<div class="ov" id="phoneOv" onclick="coOv(event,'phoneOv')">
  <div class="m">
    <div class="mh">
      <span class="mt" id="pmT">Add Fictional Phone</span>
      <button class="xb" onclick="cOv('phoneOv')">✕</button>
    </div>
    <div class="mb">
      <input type="hidden" id="eid">
      <div class="tabs">
        <button class="tab on" onclick="switchTab('info')">Info</button>
        <button class="tab" onclick="switchTab('scores')">Scores</button>
        <button class="tab" onclick="switchTab('image')">Image</button>
      </div>
      <!-- INFO -->
      <div class="tab-panel on" id="tp-info">
        <div class="fr">
          <div class="fg"><label class="fl">Brand</label><input class="fi" type="text" id="fBrand" placeholder="e.g. NovaTech"></div>
          <div class="fg"><label class="fl">Model</label><input class="fi" type="text" id="fModel" placeholder="e.g. Apex X1 Ultra"></div>
        </div>
        <div class="fr">
          <div class="fg"><label class="fl">Category</label>
            <select class="fse" id="fCat">
              <option value="flagship">Flagship</option><option value="premium">Premium</option>
              <option value="mid-range">Mid-Range</option><option value="budget">Budget</option>
              <option value="foldable">Foldable</option><option value="rugged">Rugged</option>
              <option value="gaming">Gaming</option><option value="ultra-thin">Ultra-Thin</option>
              <option value="camera-centric">Camera-Centric</option><option value="compact">Compact</option>
              <option value="enterprise">Enterprise</option>
            </select>
          </div>
          <div class="fg"><label class="fl">Price</label><input class="fi" type="text" id="fPrice" placeholder="e.g. $1,499"></div>
        </div>
        <div class="fr">
          <div class="fg"><label class="fl">Year</label><input class="fi" type="text" id="fYear" placeholder="e.g. 2025"></div>
          <div class="fg"><label class="fl">Processor</label><input class="fi" type="text" id="fProc" placeholder="e.g. Kronos 9 Gen 4"></div>
        </div>
        <div class="fr">
          <div class="fg"><label class="fl">Display</label><input class="fi" type="text" id="fDisp" placeholder='e.g. 6.9" HoloPlex OLED'></div>
          <div class="fg"><label class="fl">Battery</label><input class="fi" type="text" id="fBatt" placeholder="e.g. 7200 mAh"></div>
        </div>
        <div class="fr">
          <div class="fg"><label class="fl">Camera</label><input class="fi" type="text" id="fCam" placeholder="e.g. 200MP Triple"></div>
          <div class="fg"><label class="fl">RAM / Storage</label><input class="fi" type="text" id="fRam" placeholder="e.g. 16GB / 512GB"></div>
        </div>
        <div class="fr">
          <div class="fg full"><label class="fl">Description</label><textarea class="fta" id="fDesc" rows="3" placeholder="Describe this fictional device…"></textarea></div>
        </div>
      </div>
      <!-- SCORES -->
      <div class="tab-panel" id="tp-scores">
        <div class="sc-block">
          <div class="sc-title">Benchmark Scores — No Limit</div>
          <div class="sc-grid">
            <div class="sc-f"><label>Camera</label><input type="number" id="sC" min="0" placeholder="0" oninput="calcOv()"></div>
            <div class="sc-f"><label>Display</label><input type="number" id="sD" min="0" placeholder="0" oninput="calcOv()"></div>
            <div class="sc-f"><label>Battery</label><input type="number" id="sBt" min="0" placeholder="0" oninput="calcOv()"></div>
            <div class="sc-f"><label>Performance</label><input type="number" id="sP" min="0" placeholder="0" oninput="calcOv()"></div>
            <div class="sc-f"><label>Audio</label><input type="number" id="sA" min="0" placeholder="0" oninput="calcOv()"></div>
            <div class="sc-f"><label>Build</label><input type="number" id="sBd" min="0" placeholder="0" oninput="calcOv()"></div>
          </div>
          <div class="ov-show">
            <div class="ovn" id="ovN">—</div>
            <div class="ovl">PhantomScore™ Overall</div>
          </div>
        </div>
      </div>
      <!-- IMAGE -->
      <div class="tab-panel" id="tp-image">
        <div class="fg full">
          <label class="fl">Phone Image</label>
          <div class="iub" id="iub" onclick="document.getElementById('imgF').click()">
            <div class="iph" id="iph">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
              <span>Click to upload</span>
              <span style="font-size:.54rem;color:var(--b);letter-spacing:1px">PNG · JPG · WEBP</span>
            </div>
            <img id="iPrev" style="display:none">
          </div>
          <input type="file" id="imgF" accept="image/*" onchange="handleImg(event)">
          <button type="button" class="rim" id="rimBtn" onclick="remImg()">✕ Remove image</button>
        </div>
      </div>
    </div>
    <div class="mf">
      <button class="btn bdel" id="delBtn" style="display:none" onclick="delPhone()">Delete</button>
      <button class="btn bdup" id="dupBtn" style="display:none" onclick="dupPhone()">Duplicate</button>
      <button class="btn bgo" onclick="cOv('phoneOv')">Cancel</button>
      <button class="btn bg" onclick="savePhone()">Save</button>
    </div>
  </div>
</div>

<!-- RANK EDITOR -->
<div class="ov" id="rankOv" onclick="coOv(event,'rankOv')">
  <div class="m" style="max-width:500px">
    <div class="mh"><span class="mt">Edit Manual Rankings</span><button class="xb" onclick="cOv('rankOv')">✕</button></div>
    <div class="mb">
      <p class="rank-hint">Drag and drop to reorder. Select "Manual" sort to use this order.</p>
      <div class="rank-override" id="rankList"></div>
    </div>
    <div class="mf">
      <button class="btn bgo" onclick="cOv('rankOv')">Cancel</button>
      <button class="btn bg" onclick="saveRankOrder()">Save Order</button>
    </div>
  </div>
</div>

<!-- DETAIL -->
<div class="ov" id="detailOv" onclick="coOv(event,'detailOv')">
  <div class="m" style="max-width:500px">
    <div class="mh"><span class="mt" id="dtitle"></span><button class="xb" onclick="cOv('detailOv')">✕</button></div>
    <div id="dbody" style="padding:0"></div>
    <div class="mf" id="dfoot" style="display:none">
      <button class="btn bdel" onclick="delFromDetail()">Delete</button>
      <button class="btn bgo" onclick="editFromDetail()">Edit</button>
    </div>
  </div>
</div>

<script>
// ─── CONFIG ───
const PASS = 'qrux2025';

// ─── STATE ───
let isAdmin=false, locationOk=true;
let phones=JSON.parse(localStorage.getItem('qrux3')||'[]');
let rankOrder=JSON.parse(localStorage.getItem('qrux3order')||'[]');
let curF='all', curS='overall', curPhone=null, curImg=null, curTab='info', dragSrc=null;


// ─── TRIPLE-CLICK LOGO ───
let cc=0,ct;
document.getElementById('logoTrig').addEventListener('click',()=>{
  cc++;clearTimeout(ct);ct=setTimeout(()=>cc=0,600);
  if(cc>=3){cc=0; oOv('loginOv');}
});
window.addEventListener('scroll',()=>document.getElementById('nav').classList.toggle('s',scrollY>20));

// ─── SEED DATA ───
// Version key — bump this if you change seed data to force a reset
const SEED_VERSION = 'v2';
const storedVersion = localStorage.getItem('qrux3_version');
if(!phones.length || storedVersion !== SEED_VERSION){
  if(storedVersion !== SEED_VERSION){
    // Clear old data so seed re-applies cleanly
    phones=[];
    rankOrder=[];
    localStorage.removeItem('qrux3');
    localStorage.removeItem('qrux3order');
    localStorage.setItem('qrux3_version', SEED_VERSION);
  }
  phones=[
    {id:1,brand:'NovaTech',model:'Apex X1 Ultra',cat:'flagship',price:'$1,499',year:'2025',proc:'Kronos 9 Gen 4',disp:'6.9" HoloPlex OLED 240Hz',batt:'7200 mAh',cam:'200MP Triple + Quantum Periscope',ram:'16GB / 1TB',desc:'The pinnacle of fictional engineering. The Apex X1 Ultra pushes limits that physics has not yet defined, featuring a camera system trained on imaginary galaxies.',img:null,scores:{c:148,d:145,bt:140,p:149,a:132,bd:143}},
    {id:2,brand:'Luminae',model:'Prism Pro',cat:'camera-centric',price:'$1,199',year:'2025',proc:'HelixCore Ultra',disp:'6.7" RetinaPlex AMOLED+',batt:'5800 mAh',cam:'150MP Dual + Macro AI',ram:'12GB / 512GB',desc:"Luminae's answer to perfection. The Prism Pro delivers an optical experience so vivid, fictional critics wept upon seeing its display.",img:null,scores:{c:141,d:143,bt:132,p:137,a:140,bd:139}},
    {id:3,brand:'Vantex',model:'Fold Z2',cat:'foldable',price:'$1,899',year:'2024',proc:'StellarX 12',disp:'8.3" FlexGlass Foldable',batt:'6000 mAh',cam:'108MP Triple Hinge-Stabilised',ram:'16GB / 512GB',desc:'Folding space-time since 2024. The Fold Z2 bends at angles that challenge Euclidean geometry.',img:null,scores:{c:128,d:140,bt:118,p:130,a:115,bd:147}},
    {id:4,brand:'Ryzen Mobile',model:'Blaze Pro',cat:'gaming',price:'$999',year:'2025',proc:'GameCore Turbo X',disp:'6.8" 165Hz AMOLED',batt:'6500 mAh',cam:'64MP Dual',ram:'18GB / 256GB',desc:'Built for the fictional gamer who demands 165fps in games not yet invented.',img:null,scores:{c:98,d:135,bt:138,p:147,a:142,bd:115}},
    {id:5,brand:'Orion',model:'Slim One',cat:'ultra-thin',price:'$879',year:'2025',proc:'ThinCore G2',disp:'6.5" OLED · 4.7mm',batt:'3800 mAh',cam:'80MP Dual',ram:'8GB / 256GB',desc:'At a fictional 4.7mm, the Slim One is thinner than the width of this sentence.',img:null,scores:{c:110,d:128,bt:88,p:118,a:102,bd:141}}
  ];
  save();
}
if(!rankOrder.length) rankOrder=phones.map(p=>p.id);

function save(){localStorage.setItem('qrux3',JSON.stringify(phones));localStorage.setItem('qrux3order',JSON.stringify(rankOrder));}
function ov(s){const v=Object.values(s).map(Number);return v.length?Math.round(v.reduce((a,b)=>a+b,0)/v.length):0;}

function getOrdered(list){
  const out=[];
  rankOrder.forEach(id=>{const p=list.find(x=>x.id===id);if(p)out.push(p);});
  list.forEach(p=>{if(!out.find(x=>x.id===p.id))out.push(p);});
  return out;
}

// ─── SORT KEY MAP ───
const sortKeyMap={
  overall: p=>-ov(p.scores),
  camera:  p=>-(p.scores.c||0),
  display: p=>-(p.scores.d||0),
  battery: p=>-(p.scores.bt||0),
  performance: p=>-(p.scores.p||0),
  audio:   p=>-(p.scores.a||0),
  build:   p=>-(p.scores.bd||0),
  name:    p=>(p.brand+p.model).toLowerCase(),
  price:   p=>-(parseFloat((p.price||'0').replace(/[^0-9.]/g,''))||0),
};

// ─── ANALYSIS ───
function renderAnalysis(){
  const d=new Date();
  const days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  const months=['January','February','March','April','May','June','July','August','September','October','November','December'];
  document.getElementById('analysisDate').textContent=`${days[d.getDay()]}, ${months[d.getMonth()]} ${d.getDate()}, ${d.getFullYear()}`;
  if(!phones.length){
    document.getElementById('analysisStats').innerHTML='<div class="a-card" style="grid-column:1/-1"><div class="a-card-label">Status</div><div class="a-card-value" style="font-size:1rem;color:var(--t3)">No devices ranked yet</div></div>';
    document.getElementById('analysisInsights').innerHTML='';
    document.getElementById('analysisCatBars').innerHTML='';
    return;
  }
  const sorted=[...phones].sort((a,b)=>ov(b.scores)-ov(a.scores));
  const topPhone=sorted[0];
  const allScores=phones.map(p=>ov(p.scores));
  const avgOverall=Math.round(allScores.reduce((a,b)=>a+b,0)/allScores.length);
  const catCount={};
  phones.forEach(p=>{catCount[p.cat]=(catCount[p.cat]||0)+1;});
  const topCat=Object.entries(catCount).sort((a,b)=>b[1]-a[1])[0];
  const scoreKeys=[['c','Camera'],['d','Display'],['bt','Battery'],['p','Performance'],['a','Audio'],['bd','Build']];
  const bestScores=scoreKeys.map(([k,l])=>{
    const best=phones.reduce((prev,cur)=>(cur.scores[k]||0)>(prev.scores[k]||0)?cur:prev,phones[0]);
    return{key:k,label:l,phone:best,val:best.scores[k]||0};
  });
  const dominantScore=bestScores.reduce((a,b)=>b.val>a.val?b:a);

  document.getElementById('analysisStats').innerHTML=`
    <div class="a-card"><div class="a-card-label">Total Devices</div><div class="a-card-value">${phones.length}</div><div class="a-card-sub">across ${Object.keys(catCount).length} categories</div></div>
    <div class="a-card"><div class="a-card-label">Top Ranked</div><div class="a-card-value" style="font-size:1.05rem">${topPhone.brand} ${topPhone.model}</div><div class="a-card-sub">PhantomScore™ ${ov(topPhone.scores)}</div></div>
    <div class="a-card"><div class="a-card-label">Average Score</div><div class="a-card-value">${avgOverall}</div><div class="a-card-sub">across all devices</div></div>
    <div class="a-card"><div class="a-card-label">Score Range</div><div class="a-card-value">${Math.min(...allScores)} – ${Math.max(...allScores)}</div><div class="a-card-sub">lowest to highest</div></div>`;

  document.getElementById('analysisInsights').innerHTML=`
    <div class="a-insight"><div class="a-insight-label">Performance Leader</div><div class="a-insight-text">The <strong>${topPhone.brand} ${topPhone.model}</strong> leads with an overall PhantomScore™ of <strong>${ov(topPhone.scores)}</strong>${phones.length>1?`, placing it ${ov(topPhone.scores)-avgOverall} points above the field average`:''}.</div></div>
    <div class="a-insight"><div class="a-insight-label">Category Strength</div><div class="a-insight-text">Highest individual score: <strong>${dominantScore.val}</strong> in <strong>${dominantScore.label}</strong> by the <strong>${dominantScore.phone.brand} ${dominantScore.phone.model}</strong>. Most represented: <strong>${topCat[0]}</strong> with ${topCat[1]} device${topCat[1]>1?'s':''}.</div></div>`;

  const catAvgs=Object.entries(catCount).map(([cat])=>{
    const cp=phones.filter(p=>p.cat===cat);
    return{cat,avg:Math.round(cp.map(p=>ov(p.scores)).reduce((a,b)=>a+b,0)/cp.length),count:cp.length};
  }).sort((a,b)=>b.avg-a.avg);
  const maxAvg=Math.max(...catAvgs.map(x=>x.avg),1);
  document.getElementById('analysisCatBars').innerHTML=catAvgs.map(({cat,avg,count})=>`
    <div class="a-bar-row">
      <span class="a-bar-label">${cat}</span>
      <div class="a-bar-wrap"><div class="a-bar-fill" style="width:${(avg/maxAvg*100).toFixed(1)}%"></div></div>
      <span class="a-bar-val">${avg}<span style="font-size:.58rem;color:var(--t3);font-family:'Jost',sans-serif;font-weight:300"> ·${count}</span></span>
    </div>`).join('');
}

// ─── RENDER GRID ───
function render(){
  const g=document.getElementById('grid');
  const q=document.getElementById('srch').value.toLowerCase();
  let list=phones.filter(p=>(curF==='all'||p.cat===curF)&&(p.brand+' '+p.model).toLowerCase().includes(q));

  if(curS==='manual'){
    list=getOrdered(list);
  } else if(sortKeyMap[curS]){
    list=[...list].sort((a,b)=>{
      const ka=sortKeyMap[curS](a), kb=sortKeyMap[curS](b);
      return ka<kb?-1:ka>kb?1:0;
    });
  }

  document.getElementById('secCnt').textContent=String(list.length).padStart(2,'0');
  if(!list.length){g.innerHTML='<div class="empty"><h3>No Devices Found</h3><p>No fictional phones match your filters.</p></div>';return;}

  // Which score to highlight on cards based on sort
  const highlightMap={camera:['c','Camera'],display:['d','Display'],battery:['bt','Battery'],performance:['p','Performance'],audio:['a','Audio'],build:['bd','Build']};
  const hl=highlightMap[curS];

  g.innerHTML=list.map((p,i)=>{
    const o=ov(p.scores),rc=i===0?'r1':i===1?'r2':i===2?'r3':'';
    const imgH=p.img?`<img src="${p.img}" alt="${p.brand} ${p.model}">`:`<div class="no-img"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="9" y1="7" x2="15" y2="7"/><line x1="9" y1="11" x2="15" y2="11"/></svg><span>No Image</span></div>`;
    // Show relevant score in badge when sorting by specific category
    const badgeScore=hl?p.scores[hl[0]]||0:o;
    // Mini scores: show sorted-by score first if applicable
    let miniScores;
    if(hl){
      const otherPairs=[['c','Camera'],['d','Display'],['bt','Battery'],['p','Performance'],['a','Audio'],['bd','Build']].filter(([k])=>k!==hl[0]).slice(0,2);
      miniScores=[[hl[0],hl[1]],...otherPairs];
    } else {
      miniScores=[['c','Camera'],['d','Display'],['bt','Battery']];
    }
    return `<div class="card ${rc}" style="animation-delay:${i*.04}s">
      <div class="card-top-line"></div>
      <div class="card-rank">#${i+1}</div>
      <button class="card-edit-btn" title="Edit" onclick="event.stopPropagation();openEdit(${p.id})">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
      </button>
      <div class="card-img" onclick="openDetail(${p.id})">${imgH}<div class="card-score-badge">${badgeScore}</div></div>
      <div class="card-body" onclick="openDetail(${p.id})">
        <div class="card-meta"><span class="card-brand">${p.brand}</span><span class="card-cat">${p.cat}</span></div>
        <div class="card-name">${p.model}</div>
        <div class="card-mini">
          ${miniScores.map(([k,l])=>`<div class="ms"><div class="v">${p.scores[k]||0}</div><div class="l">${l}</div></div>`).join('')}
        </div>
      </div>
      <div class="card-foot" onclick="openDetail(${p.id})"><span class="card-price">${p.price||'—'}</span><span class="card-yr">${p.year||''}</span></div>
    </div>`;
  }).join('');
  renderAnalysis();
}

// ─── DETAIL ───
function openDetail(id){
  const p=phones.find(x=>x.id===id);if(!p)return;curPhone=p;
  const o=ov(p.scores);
  const cats=[['c','Camera'],['d','Display'],['bt','Battery'],['p','Performance'],['a','Audio'],['bd','Build']];
  const maxS=Math.max(...cats.map(([k])=>p.scores[k]||0),1);
  document.getElementById('dtitle').textContent=`${p.brand} ${p.model}`;
  document.getElementById('dbody').innerHTML=`
    <div class="dh-img">${p.img?`<img src="${p.img}" alt="${p.brand} ${p.model}">`:`<svg width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="var(--b)" stroke-width="1"><rect x="5" y="2" width="14" height="20" rx="2"/></svg>`}</div>
    <div style="padding:0 22px 20px">
      <div class="d-ov"><div class="ds">${o}</div><div class="dl">PhantomScore™ Overall</div></div>
      <div class="d-sg">${cats.map(([k,l])=>`<div class="d-sc"><div class="v">${p.scores[k]||0}</div><div class="l">${l}</div></div>`).join('')}</div>
      <div class="bars">${cats.map(([k,l])=>`<div class="br"><span class="bl">${l}</span><div class="bw"><div class="bf" style="width:${Math.min(100,((p.scores[k]||0)/maxS*100)).toFixed(1)}%"></div></div><span class="bv">${p.scores[k]||0}</span></div>`).join('')}</div>
      <p class="d-desc">${p.desc||'No description.'}</p>
      <div class="d-info">
        <div class="di"><div class="k">Display</div><div class="v">${p.disp||'—'}</div></div>
        <div class="di"><div class="k">Processor</div><div class="v">${p.proc||'—'}</div></div>
        <div class="di"><div class="k">Camera</div><div class="v">${p.cam||'—'}</div></div>
        <div class="di"><div class="k">Battery</div><div class="v">${p.batt||'—'}</div></div>
        <div class="di"><div class="k">RAM / Storage</div><div class="v">${p.ram||'—'}</div></div>
        <div class="di"><div class="k">Category</div><div class="v" style="text-transform:capitalize">${p.cat||'—'}</div></div>
        <div class="di"><div class="k">Price</div><div class="v">${p.price||'—'}</div></div>
        <div class="di"><div class="k">Year</div><div class="v">${p.year||'—'}</div></div>
      </div>
    </div>`;
  document.getElementById('dfoot').style.display=isAdmin?'flex':'none';
  oOv('detailOv');
}
function editFromDetail(){cOv('detailOv');openEdit(curPhone.id);}
function delFromDetail(){
  if(!confirm(`Delete "${curPhone.brand} ${curPhone.model}"?`))return;
  phones=phones.filter(x=>x.id!==curPhone.id);
  rankOrder=rankOrder.filter(x=>x!==curPhone.id);
  save();cOv('detailOv');render();
}

// ─── TABS ───
function switchTab(t){
  curTab=t;
  document.querySelectorAll('.tab').forEach(b=>b.classList.toggle('on',b.getAttribute('onclick').includes(`'${t}'`)));
  document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('on'));
  document.getElementById('tp-'+t).classList.add('on');
}

// ─── ADD ───
function openAdd(){
  document.getElementById('pmT').textContent='Add Fictional Phone';
  document.getElementById('eid').value='';
  document.getElementById('delBtn').style.display='none';
  document.getElementById('dupBtn').style.display='none';
  ['fBrand','fModel','fPrice','fYear','fDisp','fProc','fBatt','fCam','fDesc','fRam'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('fCat').value='flagship';
  ['sC','sD','sBt','sP','sA','sBd'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('ovN').textContent='—';
  curImg=null;resetImg();switchTab('info');oOv('phoneOv');
}

// ─── EDIT ───
function openEdit(id){
  const p=phones.find(x=>x.id===id);if(!p)return;
  document.getElementById('pmT').textContent='Edit Device';
  document.getElementById('eid').value=id;
  document.getElementById('delBtn').style.display='';
  document.getElementById('dupBtn').style.display='';
  document.getElementById('fBrand').value=p.brand||'';
  document.getElementById('fModel').value=p.model||'';
  document.getElementById('fPrice').value=p.price||'';
  document.getElementById('fYear').value=p.year||'';
  document.getElementById('fDisp').value=p.disp||'';
  document.getElementById('fProc').value=p.proc||'';
  document.getElementById('fBatt').value=p.batt||'';
  document.getElementById('fCam').value=p.cam||'';
  document.getElementById('fDesc').value=p.desc||'';
  document.getElementById('fRam').value=p.ram||'';
  document.getElementById('fCat').value=p.cat||'flagship';
  document.getElementById('sC').value=p.scores.c||0;
  document.getElementById('sD').value=p.scores.d||0;
  document.getElementById('sBt').value=p.scores.bt||0;
  document.getElementById('sP').value=p.scores.p||0;
  document.getElementById('sA').value=p.scores.a||0;
  document.getElementById('sBd').value=p.scores.bd||0;
  curImg=p.img||null;
  if(curImg){document.getElementById('iPrev').src=curImg;document.getElementById('iPrev').style.display='block';document.getElementById('iph').style.display='none';document.getElementById('iub').classList.add('has');document.getElementById('rimBtn').style.display='block';}
  else resetImg();
  calcOv();switchTab('info');oOv('phoneOv');
}

function savePhone(){
  const br=document.getElementById('fBrand').value.trim(),mo=document.getElementById('fModel').value.trim();
  if(!br||!mo){alert('Brand and Model are required.');return;}
  const d={brand:br,model:mo,cat:document.getElementById('fCat').value,price:document.getElementById('fPrice').value.trim(),year:document.getElementById('fYear').value.trim(),disp:document.getElementById('fDisp').value.trim(),proc:document.getElementById('fProc').value.trim(),batt:document.getElementById('fBatt').value.trim(),cam:document.getElementById('fCam').value.trim(),ram:document.getElementById('fRam').value.trim(),desc:document.getElementById('fDesc').value.trim(),img:curImg,scores:{c:+document.getElementById('sC').value||0,d:+document.getElementById('sD').value||0,bt:+document.getElementById('sBt').value||0,p:+document.getElementById('sP').value||0,a:+document.getElementById('sA').value||0,bd:+document.getElementById('sBd').value||0}};
  const eid=document.getElementById('eid').value;
  if(eid){const i=phones.findIndex(x=>x.id==eid);if(i>=0)phones[i]={...phones[i],...d};}
  else{d.id=Date.now();phones.push(d);rankOrder.push(d.id);}
  save();cOv('phoneOv');render();
}

// ─── DUPLICATE ───
function dupPhone(){
  const eid=document.getElementById('eid').value;if(!eid)return;
  const src=phones.find(x=>x.id==eid);if(!src)return;
  const copy=JSON.parse(JSON.stringify(src));
  copy.id=Date.now();copy.model=src.model+' (Copy)';
  phones.push(copy);rankOrder.push(copy.id);
  save();cOv('phoneOv');render();
}

// ─── DELETE ───
function delPhone(){
  const eid=document.getElementById('eid').value;if(!eid)return;
  const p=phones.find(x=>x.id==eid);
  if(!confirm(`Delete "${p?p.brand+' '+p.model:'this phone'}"?`))return;
  phones=phones.filter(x=>x.id!=eid);rankOrder=rankOrder.filter(x=>x!=eid);
  save();cOv('phoneOv');render();
}

// ─── RANK EDITOR ───
function openRankEditor(){
  const rl=document.getElementById('rankList');
  const ordered=getOrdered(phones);
  rl.innerHTML=ordered.map((p,i)=>`
    <div class="rank-item" draggable="true" data-id="${p.id}" ondragstart="dStart(event)" ondragover="dOver(event)" ondrop="dDrop(event)" ondragend="dEnd(event)">
      <span class="ri-num">${i+1}</span>
      <div class="ri-img">${p.img?`<img src="${p.img}">`:`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--b)" stroke-width="1"><rect x="5" y="2" width="14" height="20" rx="2"/></svg>`}</div>
      <div class="ri-name"><div class="ri-brand">${p.brand}</div><div class="ri-model">${p.model}</div></div>
      <div class="ri-score">${ov(p.scores)}</div>
      <span class="ri-drag">⠿</span>
    </div>`).join('');
  oOv('rankOv');
}
function dStart(e){dragSrc=e.currentTarget;e.currentTarget.classList.add('dragging');e.dataTransfer.effectAllowed='move';}
function dOver(e){e.preventDefault();document.querySelectorAll('.rank-item').forEach(el=>el.classList.remove('drag-over'));e.currentTarget.classList.add('drag-over');}
function dEnd(){document.querySelectorAll('.rank-item').forEach(el=>{el.classList.remove('dragging');el.classList.remove('drag-over');});}
function dDrop(e){
  e.preventDefault();const target=e.currentTarget;if(dragSrc===target)return;
  const rl=document.getElementById('rankList');
  const items=[...rl.querySelectorAll('.rank-item')];
  if(items.indexOf(dragSrc)<items.indexOf(target))target.after(dragSrc);else target.before(dragSrc);
  [...rl.querySelectorAll('.rank-item')].forEach((el,i)=>el.querySelector('.ri-num').textContent=i+1);
}
function saveRankOrder(){
  rankOrder=[...document.querySelectorAll('#rankList .rank-item')].map(el=>+el.dataset.id);
  save();cOv('rankOv');render();
}

// ─── IMAGE ───
function handleImg(e){
  const f=e.target.files[0];if(!f)return;
  const r=new FileReader();
  r.onload=ev=>{curImg=ev.target.result;document.getElementById('iPrev').src=curImg;document.getElementById('iPrev').style.display='block';document.getElementById('iph').style.display='none';document.getElementById('iub').classList.add('has');document.getElementById('rimBtn').style.display='block';};
  r.readAsDataURL(f);
}
function remImg(){curImg=null;resetImg();document.getElementById('imgF').value='';}
function resetImg(){document.getElementById('iPrev').style.display='none';document.getElementById('iPrev').src='';document.getElementById('iph').style.display='flex';document.getElementById('iub').classList.remove('has');document.getElementById('rimBtn').style.display='none';}
function calcOv(){
  const vals=['sC','sD','sBt','sP','sA','sBd'].map(i=>parseFloat(document.getElementById(i).value)||0);
  const filled=vals.filter(v=>v>0);
  const avg=filled.length?Math.round(vals.reduce((a,b)=>a+b,0)/vals.length):0;
  document.getElementById('ovN').textContent=avg||0;
  // Warn if some scores are still 0
  const ovlEl=document.querySelector('.ov-show .ovl');
  if(ovlEl){
    const zeros=vals.filter(v=>v===0).length;
    ovlEl.textContent=zeros>0?`PhantomScore™ Overall (${zeros} score${zeros>1?'s':''} empty — counted as 0)`:'PhantomScore™ Overall';
  }
}

// ─── ADMIN LOGIN ───
function doLogin(){
  document.getElementById('lerr').style.display='none';
  if(document.getElementById('pwIn').value!==PASS){
    document.getElementById('lerr').style.display='block';return;
  }
  isAdmin=true;cOv('loginOv');
  document.getElementById('fab').classList.add('on');
  document.getElementById('adminBadge').style.display='';
  document.body.classList.add('admin-on');
  document.getElementById('pwIn').value='';
  if(!document.getElementById('rankEditBtn')){
    const b=document.createElement('button');
    b.className='nav-pill';b.id='rankEditBtn';b.textContent='Edit Rankings';b.onclick=openRankEditor;
    document.querySelector('.nav-r').insertBefore(b,document.getElementById('adminBadge'));
  }
}

// ─── UTILS ───
function setF(f,btn){curF=f;document.querySelectorAll('.fp').forEach(b=>b.classList.remove('on'));if(btn)btn.classList.add('on');else document.querySelectorAll('.fp').forEach(b=>{if(b.getAttribute('onclick').includes(`'${f}'`))b.classList.add('on');});render();}
function setS(s,btn){curS=s;document.querySelectorAll('.sbtn').forEach(b=>b.classList.remove('on'));btn.classList.add('on');render();}
function oOv(id){document.getElementById(id).classList.add('on');}
function cOv(id){document.getElementById(id).classList.remove('on');}
function coOv(e,id){if(e.target.id===id)cOv(id);}
function goTo(id){document.getElementById(id).scrollIntoView({behavior:'smooth',block:'start'});}
function fNav(f){setF(f,null);goTo('rankings');}

render();
</script>
</body>
</html>
